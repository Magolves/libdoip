<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="778px" preserveAspectRatio="none" style="width:1163px;height:778px;" version="1.1" viewBox="0 0 1163 778" width="1163px" zoomAndPan="magnify"><defs><filter height="300%" id="fjkjeffx7iaul" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="235" x="465" y="29.2419">DoIP ServerModel Overview</text><rect fill="#FFFFFF" filter="url(#fjkjeffx7iaul)" height="178.2361" style="stroke: #000000; stroke-width: 2.0;" width="1139" x="13" y="461.6439"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="45" x2="45" y1="127.5838" y2="688.586"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="285.5" x2="285.5" y1="127.5838" y2="688.586"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="525" x2="525" y1="127.5838" y2="688.586"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="843.5" x2="843.5" y1="127.5838" y2="688.586"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1067" x2="1067" y1="127.5838" y2="688.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="23" y="123.4818">Client</text><ellipse cx="45.5" cy="51.5158" fill="#FEFECE" filter="url(#fjkjeffx7iaul)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M45.5,59.5158 L45.5,86.5158 M32.5,67.5158 L58.5,67.5158 M45.5,86.5158 L32.5,101.5158 M45.5,86.5158 L58.5,101.5158 " fill="none" filter="url(#fjkjeffx7iaul)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="23" y="702.552">Client</text><ellipse cx="45.5" cy="716.654" fill="#FEFECE" filter="url(#fjkjeffx7iaul)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M45.5,724.654 L45.5,751.654 M32.5,732.654 L58.5,732.654 M45.5,751.654 L32.5,766.654 M45.5,751.654 L58.5,766.654 " fill="none" filter="url(#fjkjeffx7iaul)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fjkjeffx7iaul)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="239.5" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="246.5" y="111.4818">DoIPServer</text><rect fill="#FEFECE" filter="url(#fjkjeffx7iaul)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="239.5" y="687.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="246.5" y="709.552">DoIPServer</text><rect fill="#FEFECE" filter="url(#fjkjeffx7iaul)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="463" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="470" y="111.4818">DoIPConnection</text><rect fill="#FEFECE" filter="url(#fjkjeffx7iaul)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="463" y="687.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="470" y="709.552">DoIPConnection</text><rect fill="#FEFECE" filter="url(#fjkjeffx7iaul)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="776.5" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="783.5" y="111.4818">DoIPServerModel</text><rect fill="#FEFECE" filter="url(#fjkjeffx7iaul)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="776.5" y="687.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="783.5" y="709.552">DoIPServerModel</text><rect fill="#FEFECE" filter="url(#fjkjeffx7iaul)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="145" x="993" y="89.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="131" x="1000" y="111.4818">UDS Backend / CAN</text><rect fill="#FEFECE" filter="url(#fjkjeffx7iaul)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="145" x="993" y="687.586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="131" x="1000" y="709.552">UDS Backend / CAN</text><polygon fill="#A80036" points="273.5,157.2898,283.5,161.2898,273.5,165.2898,277.5,161.2898" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="45.5" x2="279.5" y1="161.2898" y2="161.2898"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="52.5" y="155.4808">TCP connect</text><polygon fill="#A80036" points="513.5,188.9958,523.5,192.9958,513.5,196.9958,517.5,192.9958" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="285.5" x2="519.5" y1="192.9958" y2="192.9958"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="292.5" y="187.1868">createConnection(ctx)</text><polygon fill="#A80036" points="831.5,220.7018,841.5,224.7018,831.5,228.7018,835.5,224.7018" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="525.5" x2="837.5" y1="224.7018" y2="224.7018"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="532.5" y="218.8928">onOpenConnection(ctx)</text><polygon fill="#A80036" points="273.5,252.4078,283.5,256.4078,273.5,260.4078,277.5,256.4078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="45.5" x2="279.5" y1="256.4078" y2="256.4078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="52.5" y="250.5988">Routing Activation Request (0x0004)</text><polygon fill="#A80036" points="513.5,284.1138,523.5,288.1138,513.5,292.1138,517.5,288.1138" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="285.5" x2="519.5" y1="288.1138" y2="288.1138"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="292.5" y="282.3048">Routing Activation Request (0x0004)</text><polygon fill="#A80036" points="831.5,315.8199,841.5,319.8199,831.5,323.8199,835.5,319.8199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="525.5" x2="837.5" y1="319.8199" y2="319.8199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="284" x="532.5" y="314.0109">onRoutingActivationRequest(ctx, msg, callback)</text><polygon fill="#A80036" points="536.5,347.5259,526.5,351.5259,536.5,355.5259,532.5,351.5259" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="530.5" x2="842.5" y1="351.5259" y2="351.5259"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="542.5" y="345.7169">invoke callback with Routing Activation Response</text><polygon fill="#A80036" points="56.5,379.2319,46.5,383.2319,56.5,387.2319,52.5,383.2319" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="50.5" x2="524.5" y1="383.2319" y2="383.2319"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="62.5" y="377.4229">Routing Activation Response (0x0005)</text><polygon fill="#A80036" points="513.5,410.9379,523.5,414.9379,513.5,418.9379,517.5,414.9379" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="45.5" x2="519.5" y1="414.9379" y2="414.9379"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="52.5" y="409.1289">Diagnostic Message (0x8001)</text><polygon fill="#A80036" points="56.5,442.6439,46.5,446.6439,56.5,450.6439,52.5,446.6439" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="50.5" x2="524.5" y1="446.6439" y2="446.6439"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="62.5" y="440.8349">Diagnostic Ack (0x8002)</text><path d="M13,461.6439 L76,461.6439 L76,470.6439 L66,480.6439 L13,480.6439 L13,461.6439 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="178.2361" style="stroke: #000000; stroke-width: 2.0;" width="1139" x="13" y="461.6439"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="28" y="476.5409">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="91" y="475.4028">[downstream forwarding]</text><polygon fill="#A80036" points="831.5,501.056,841.5,505.056,831.5,509.056,835.5,505.056" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="525.5" x2="837.5" y1="505.056" y2="505.056"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="253" x="532.5" y="499.247">onDownstreamRequest(ctx, msg, callback)</text><polygon fill="#A80036" points="1055.5,532.762,1065.5,536.762,1055.5,540.762,1059.5,536.762" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="843.5" x2="1061.5" y1="536.762" y2="536.762"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="850.5" y="530.953">forward diagnostic payload (CAN)</text><polygon fill="#A80036" points="854.5,564.468,844.5,568.468,854.5,572.468,850.5,568.468" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="848.5" x2="1066.5" y1="568.468" y2="568.468"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="860.5" y="562.659">downstream response (CAN)</text><polygon fill="#A80036" points="536.5,596.174,526.5,600.174,536.5,604.174,532.5,600.174" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="530.5" x2="842.5" y1="600.174" y2="600.174"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="542.5" y="594.365">invoke callback with downstream response</text><polygon fill="#A80036" points="56.5,627.88,46.5,631.88,56.5,635.88,52.5,631.88" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="50.5" x2="524.5" y1="631.88" y2="631.88"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="62.5" y="626.071">Diagnostic Message (0x8001) [downstream response]</text><polygon fill="#A80036" points="831.5,666.586,841.5,670.586,831.5,674.586,835.5,670.586" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="525.5" x2="837.5" y1="670.586" y2="670.586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="532.5" y="664.777">onDiagnosticNotification(ctx, ack)</text><!--MD5=[8a646be1a915a0a806e60bef35791db7]
@startuml
title DoIP ServerModel Overview

actor Client
participant "DoIPServer" as Server
participant "DoIPConnection" as Connection
participant "DoIPServerModel" as Model
participant "UDS Backend / CAN" as Backend


Client -> Server: TCP connect
Server -> Connection: createConnection(ctx)
Connection -> Model: onOpenConnection(ctx)

Client -> Server : Routing Activation Request (0x0004)
Server -> Connection: Routing Activation Request (0x0004)
Connection -> Model: onRoutingActivationRequest(ctx, msg, callback)
Model -> Connection: invoke callback with Routing Activation Response
Connection -> Client: Routing Activation Response (0x0005)

Client -> Connection: Diagnostic Message (0x8001)

Connection -> Client: Diagnostic Ack (0x8002)

alt downstream forwarding
	Connection -> Model: onDownstreamRequest(ctx, msg, callback)
	Model -> Backend: forward diagnostic payload (CAN)
	Backend -> Model: downstream response (CAN)
    Model -> Connection: invoke callback with downstream response
	Connection -> Client: Diagnostic Message (0x8001) [downstream response]
end

Connection -> Model: onDiagnosticNotification(ctx, ack)

@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.9+10-Ubuntu-124.04
Operating System: Linux
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>